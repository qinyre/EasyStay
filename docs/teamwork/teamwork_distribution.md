# 易宿酒店预订平台 - 团队分工协作文档

## 0. 协作核心原则：接口先行

为了实现**进度互不干扰**，项目启动后的前两个小时，三人必须共同确认 `docs/technical/api_spec.md` 中的字段名。一旦确认，前端使用 Mock 数据（静态假数据）开发界面，后端独立开发接口逻辑。

---

## 1. 成员 A：移动端前端工程师 (Mobile Developer)

**核心目标**：负责 C 端用户体验，确保预定流程流畅。

**技术栈**：React 18 + TypeScript + Vite + Ant Design Mobile + Tailwind CSS

### 页面开发任务

#### 酒店查询页 (首页 - `/`)
* 实现顶部广告 Banner 及其跳转逻辑
* 实现搜索栏、定位功能及快捷标签展示
* 热门城市横向滚动列表
* **技术难点**：独立开发**日历组件** (`CalendarPicker`)，支持入住与离店日期选择，最多180晚

#### 酒店列表页 (`/hotels`)
* 实现多维度筛选头（城市、日期、星级、价格区间、标签）
* **技术得分点**：开发**虚拟列表**优化（使用 `ahooks` 的 `useVirtualList`），支持下拉刷新和无限滚动
* 实现筛选面板（排序、价格、星级、标签）
* 返回顶部按钮

#### 酒店详情页 (`/hotel/:id`)
* 实现图片轮播 Banner（优化预加载策略）
* 实现动态透明度导航栏
* **逻辑难点**：对后端返回的房型数据进行**价格由低到高排序**呈现
* 实现日期选择器
* 设施图标展示

#### 订单相关页面
* **预订确认页** (`/hotel/:hotelId/booking/:roomId`)：入住人信息表单、费用明细、同意条款
* **预订成功页** (`/booking/success`)：订单展示
* **我的订单页** (`/bookings`)：标签筛选、订单卡片、倒计时显示（15分钟支付时限）
* **订单详情页** (`/booking/:id`)：订单状态、进度条、操作按钮

#### 用户认证页面
* **登录页** (`/login`)：手机号+密码表单
* **注册页** (`/register`)：手机号、邮箱、密码表单
* **忘记密码页** (`/forgot-password`)：邮箱验证码重置密码

#### 个人中心页面
* **个人中心** (`/profile`)：用户信息、登录状态判断
* **设置页** (`/settings`)：语言切换（中/英）
* **关于我们** (`/about`)
* **法律页面**：用户协议、隐私政策

### 技术实现要求

#### 状态管理
* **SearchContext**：管理搜索参数（城市、日期、关键词、筛选条件）
* **AuthContext**：管理用户认证状态（登录、注册、登出）
* **ProtectedRoute**：路由守卫，保护需要认证的页面

#### 自定义 Hooks
* **useCountdown**：倒计时 Hook（分:秒格式、过期回调）

#### API 切换机制
* 支持通过环境变量 `VITE_USE_REAL_API` 切换真实 API 和 Mock 数据
* 实现自动回退机制（API 失败自动使用 Mock 数据）

#### 国际化
* 使用 i18next 实现中英文切换
* 覆盖所有页面文本

#### 测试
* 使用 Vitest + Testing Library 编写单元测试
* 测试覆盖率目标：工具函数 100%，组件 80%+，Context 90%+

---

## 2. 成员 B：PC 管理端前端工程师 (PC Admin Developer)

**核心目标**：负责 B 端管理逻辑，确保商户与管理员操作闭环。

### 登录与注册页

* 开发注册界面，支持"商户"与"管理员"角色选择
* 实现登录逻辑，需根据后端返回的账号信息**自动判断并跳转**对应后台

### 酒店信息录入/编辑页 (商户端)

* 构建复杂表单，涵盖酒店名（中/英）、星级、价格、开业时间等**必须维度**
* 实现房型管理（添加、删除、编辑）
* 实现图片上传功能
* 实现数据保存功能，并确保实时触发同步

### 审核与下线列表页 (管理员端)

* 开发审核功能，支持填写"不通过原因"
* 实现**"下线/恢复"切换逻辑**（即虚拟删除功能）

---

## 3. 成员 C：后端全栈工程师 (Backend & DB Coordinator)

**核心目标**：负责数据持久化、接口实现及全局文档。

**技术栈**：Node.js + Express.js + SQLite (better-sqlite3)

### 服务端架构

* 使用 Node.js + Express 搭建基础服务框架
* 设计并维护 SQLite 数据库结构（`hotels`、`rooms`、`users`、`orders` 表）
* 实现 JWT 认证中间件
* 实现图片上传中间件

### API 接口实现

#### 认证接口
* 用户注册（支持 user、merchant 角色）
* 用户登录（手机号+密码）
* 获取当前用户信息
* 发送密码重置验证码
* 验证验证码
* 使用验证码重置密码
* 用户登出

#### 移动端接口
* 获取首页 Banner
* 获取热门城市
* 酒店列表查询（支持多维度筛选、分页）
* 酒店详情获取（房型按价格升序）
* 创建订单
* 获取订单列表
* 获取订单详情
* 取消订单
* 更新订单状态

#### 管理端接口
* 酒店信息录入（商户）
* 酒店信息编辑（商户）
* 酒店信息审核（管理员：通过/不通过/待审核）
* 发布/下线管理（管理员，虚拟删除）

### 数据一致性保障

* 实现 SQLite 事务处理，确保数据一致性
* **技术得分点**：确保商户端修改后的数据能**实时通过 API 更新**至移动端
* 实现内存缓存机制，热点数据加速访问

### 公共交付物

* 负责编写最终的 `README.md` 项目运行指南
* 维护 API 接口文档

---

## 4. 进度同步路线图

| 时间 | 成员 A 任务 | 成员 B 任务 | 成员 C 任务 |
| :--- | :--- | :--- | :--- |
| **第 1 天** | 三人对齐 API 字段（docs 目录搭建完成） | 同左 | 同左 |
| **第 2-3 天** | 攻克日历组件与长列表优化 | 攻克录入表单 | 完成 SQLite 读写接口 |
| **第 4-5 天** | 完成订单流程页面 | 完成审核与下线功能 | 完成认证与订单接口 |
| **第 6 天** | 完善用户认证与个人中心 | 联调测试 | 联调测试 |
| **第 7 天** | 全面联调，将前端地址由本地 Mock 切换为后端地址 | 同左 | 对照测试文档进行最终验收 |

---

## 5. 交付物清单

### 成员 A 交付物
- [ ] 完整的移动端应用代码
- [ ] 单元测试代码（覆盖率达标）
- [ ] 移动端 API 对接文档 (`client-mobile/API_INTEGRATION.md`)
- [ ] 移动端 AI 上下文文档 (`client-mobile/CLAUDE.md`)

### 成员 B 交付物
- [ ] 完整的 PC 管理端应用代码
- [ ] 商户录入功能
- [ ] 管理员审核功能

### 成员 C 交付物
- [ ] 完整的后端服务代码
- [ ] SQLite 数据库建表脚本
- [ ] API 接口文档 (`docs/technical/api_spec.md`)
- [ ] 数据结构文档 (`docs/technical/data_schema.md`)
- [ ] 项目运行指南 (`README.md`)

---

## 6. 技术规范约束

1. **房型排序规则**：详情页房型必须按价格从低到高排序
2. **虚拟删除机制**：下线操作仅修改 `is_offline` 标志，数据可恢复
3. **响应格式统一**：后端必须返回 `{ code: 200, data: {...}, message: "success" }` 格式
4. **日期格式统一**：使用 `yyyy-MM-dd` 格式
5. **环境变量控制**：移动端通过 `VITE_USE_REAL_API` 控制 Mock/真实 API 切换
